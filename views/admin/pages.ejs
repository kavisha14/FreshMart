<%-include('../_layouts/adminheader'); %>

<h2 class="page-title">Pages</h2>
<a href = "/admin/pages/add-page" class="btn btn-primary">Add a new page</a>
<br/><br/>

<table class="table table-striped">
   <thead>
       <tr class="home">
           <th>Title</th>
           <th>Edit</th>
           <th>Delete</th>
       </tr>
   </thead>
   <tbody class="sorting">
       <% pages.forEach(function(page){ %>
       <tr class="sort-algo" id="id_<%= page._id %>" class="<%= pages.slug %>">
           <td><%= page.title %></td>
           <td><a href="/admin/pages/edit-page/<%= page.slug %>">Edit</a></td>
           <% if (page.slug == "home") { %>
                <td></td>
           <% } else {%>
           <td><a href="/admin/pages/delete-page/<%= page._id %>">Delete</a></td>
           <% }%>
       </tr>
       <% }); %>
   </tbody>
</table>


<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>


<!--<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>-->
<script>

    $('tbody').sortable({
        
        items: "tr:not('.home')",
        placeholder: "ui-state-highlight",
        Update: function(){
            var id = $('tbody').sortable("serialize").toString();
            console.log(id);
            var url = "/admin/pages/reorder-page";
            
            $.post(url, id);
        }
    });
    
</script>

<%- include('../_layouts/adminfooter'); %>
